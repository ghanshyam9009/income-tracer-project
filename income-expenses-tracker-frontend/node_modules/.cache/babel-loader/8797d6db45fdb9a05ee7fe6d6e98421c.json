{"ast":null,"code":"import _regeneratorRuntime from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{createContext,useReducer}from\"react\";import axios from\"axios\";import{LOGIN_SUCCESS,LOGIN_FAILED,FETCH_PROFILE_FAIL,FETCH_PROFILE_SUCCESS,LOGOUT,REGISTER_SUCCESS,REGISTER_FAIL}from\"./authActionTypes\";import{API_URL_USER}from\"../../../utils/apiURL\";//auth context\nimport{jsx as _jsx}from\"react/jsx-runtime\";export var authContext=/*#__PURE__*/createContext();//Initial state\nvar INITIAL_STATE={userAuth:JSON.parse(localStorage.getItem(\"userAuth\")),error:null,loading:false,profile:null};//Auth Reducer\nvar reducer=function reducer(state,action){var type=action.type,payload=action.payload;switch(type){//Register\ncase REGISTER_SUCCESS:return _objectSpread(_objectSpread({},state),{},{loading:false,error:null,userAuth:payload});case REGISTER_FAIL:return _objectSpread(_objectSpread({},state),{},{error:payload,loading:false,userAuth:null});case LOGIN_SUCCESS://Add user to localstorage\nlocalStorage.setItem(\"userAuth\",JSON.stringify(payload));return _objectSpread(_objectSpread({},state),{},{loading:false,error:null,userAuth:payload});case LOGIN_FAILED:return _objectSpread(_objectSpread({},state),{},{error:payload,loading:false,userAuth:null});// Profile\ncase FETCH_PROFILE_SUCCESS:return _objectSpread(_objectSpread({},state),{},{loading:false,error:null,profile:payload});case FETCH_PROFILE_FAIL:return _objectSpread(_objectSpread({},state),{},{loading:false,error:payload,profile:null});// logout\ncase LOGOUT://remove from storage\nlocalStorage.removeItem(\"userAuth\");return _objectSpread(_objectSpread({},state),{},{loading:false,error:null,userAuth:null});default:return state;}};//Provider\nvar AuthContextProvider=function AuthContextProvider(_ref){var _state$userAuth2;var children=_ref.children;var _useReducer=useReducer(reducer,INITIAL_STATE),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];//login action\nvar loginUserAction=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(formData){var config,_res$data,res,_error$response,_error$response$data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context.prev=1;_context.next=4;return axios.post(\"\".concat(API_URL_USER,\"/login\"),formData,config);case 4:res=_context.sent;if((res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.status)===\"success\"){dispatch({type:LOGIN_SUCCESS,payload:res.data});}//Redirect\nwindow.location.href=\"/dashboard\";_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch({type:LOGIN_FAILED,payload:_context.t0===null||_context.t0===void 0?void 0:(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message});case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function loginUserAction(_x){return _ref2.apply(this,arguments);};}();//login action\nvar registerUserAction=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(formData){var config,_res$data2,res,_error$response2,_error$response2$data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context2.prev=1;_context2.next=4;return axios.post(\"\".concat(API_URL_USER,\"/register\"),formData,config);case 4:res=_context2.sent;if((res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.status)===\"success\"){dispatch({type:REGISTER_SUCCESS,payload:res.data});}//Redirect\nwindow.location.href=\"/login\";_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch({type:REGISTER_FAIL,payload:_context2.t0===null||_context2.t0===void 0?void 0:(_error$response2=_context2.t0.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function registerUserAction(_x2){return _ref3.apply(this,arguments);};}();//Profile Action\n// const fetchProfileAction = async () => {\n//   try {\n//     const config = {\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//         Authorization: `Bearer ${state?.userAuth?.token}`,\n//       },\n//     };\n//     const res = await axios.get(`${API_URL_USER}/profile`,config);\n//     console.log(res);\n//     if (res?.data) {\n//       dispatch({\n//         type: FETCH_PROFILE_SUCCESS,\n//         payload: res.data,\n//       });\n//     }\n//   } catch (error) {\n//     dispatch({\n//       type: FETCH_PROFILE_FAIL,\n//       payload: error?.response?.data?.message,\n//     });\n//   }\n// };\nvar fetchProfileAction=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _state$userAuth,config,res,_error$response3,_error$response3$data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;config={headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(state===null||state===void 0?void 0:(_state$userAuth=state.userAuth)===null||_state$userAuth===void 0?void 0:_state$userAuth.token)}};_context3.next=4;return axios.get(\"\".concat(API_URL_USER,\"/profile\"),config);case 4:res=_context3.sent;console.log(\"My res \",res);if(res!==null&&res!==void 0&&res.data){dispatch({type:FETCH_PROFILE_SUCCESS,payload:res.data});}_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);dispatch({type:FETCH_PROFILE_FAIL,payload:_context3.t0===null||_context3.t0===void 0?void 0:(_error$response3=_context3.t0.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9]]);}));return function fetchProfileAction(){return _ref4.apply(this,arguments);};}();//Logout\nvar logoutUserAction=function logoutUserAction(){dispatch({type:LOGOUT,payload:null});//Redirect\nwindow.location.href=\"/login\";};return/*#__PURE__*/_jsx(authContext.Provider,{value:{loginUserAction:loginUserAction,userAuth:state,token:state===null||state===void 0?void 0:(_state$userAuth2=state.userAuth)===null||_state$userAuth2===void 0?void 0:_state$userAuth2.token,fetchProfileAction:fetchProfileAction,profile:state===null||state===void 0?void 0:state.profile,error:state===null||state===void 0?void 0:state.error,logoutUserAction:logoutUserAction,registerUserAction:registerUserAction},children:children});};export default AuthContextProvider;","map":{"version":3,"names":["createContext","useReducer","axios","LOGIN_SUCCESS","LOGIN_FAILED","FETCH_PROFILE_FAIL","FETCH_PROFILE_SUCCESS","LOGOUT","REGISTER_SUCCESS","REGISTER_FAIL","API_URL_USER","authContext","INITIAL_STATE","userAuth","JSON","parse","localStorage","getItem","error","loading","profile","reducer","state","action","type","payload","setItem","stringify","removeItem","AuthContextProvider","children","dispatch","loginUserAction","formData","config","headers","post","res","data","status","window","location","href","response","message","registerUserAction","fetchProfileAction","Authorization","token","get","console","log","logoutUserAction"],"sources":["C:/income tracer project/income-expenses-tracker (frontend)/src/components/context/AuthContext/AuthContext.js"],"sourcesContent":["import { createContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport {\n  LOGIN_SUCCESS,\n  LOGIN_FAILED,\n  FETCH_PROFILE_FAIL,\n  FETCH_PROFILE_SUCCESS,\n  LOGOUT,\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n} from \"./authActionTypes\";\nimport { API_URL_USER } from \"../../../utils/apiURL\";\n\n//auth context\nexport const authContext = createContext();\n\n//Initial state\nconst INITIAL_STATE = {\n  userAuth: JSON.parse(localStorage.getItem(\"userAuth\")),\n  error: null,\n  loading: false,\n  profile: null,\n};\n//Auth Reducer\n\nconst reducer = (state, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    //Register\n    case REGISTER_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: payload,\n      };\n    case REGISTER_FAIL:\n      return {\n        ...state,\n        error: payload,\n        loading: false,\n        userAuth: null,\n      };\n\n    case LOGIN_SUCCESS:\n      //Add user to localstorage\n      localStorage.setItem(\"userAuth\", JSON.stringify(payload));\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: payload,\n      };\n    case LOGIN_FAILED:\n      return {\n        ...state,\n        error: payload,\n        loading: false,\n        userAuth: null,\n      };\n    // Profile\n    case FETCH_PROFILE_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        profile: payload,\n      };\n    case FETCH_PROFILE_FAIL:\n      return {\n        ...state,\n        loading: false,\n        error: payload,\n        profile: null,\n      };\n    // logout\n    case LOGOUT:\n      //remove from storage\n      localStorage.removeItem(\"userAuth\");\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: null,\n      };\n    default:\n      return state;\n  }\n};\n\n//Provider\nconst AuthContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, INITIAL_STATE);\n\n  //login action\n  const loginUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    try {\n      const res = await axios.post(`${API_URL_USER}/login`, formData, config);\n      if (res?.data?.status === \"success\") {\n        dispatch({\n          type: LOGIN_SUCCESS,\n          payload: res.data,\n        });\n      }\n      //Redirect\n      window.location.href = \"/dashboard\";\n    } catch (error) {\n      dispatch({\n        type: LOGIN_FAILED,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n\n  //login action\n  const registerUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    try {\n      const res = await axios.post(\n        `${API_URL_USER}/register`,\n        formData,\n        config\n      );\n      if (res?.data?.status === \"success\") {\n        dispatch({\n          type: REGISTER_SUCCESS,\n          payload: res.data,\n        });\n      }\n      //Redirect\n      window.location.href = \"/login\";\n    } catch (error) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n\n  //Profile Action\n  // const fetchProfileAction = async () => {\n  //   try {\n  //     const config = {\n  //       headers: {\n  //         \"Content-Type\": \"application/json\",\n  //         Authorization: `Bearer ${state?.userAuth?.token}`,\n  //       },\n  //     };\n  //     const res = await axios.get(`${API_URL_USER}/profile`,config);\n  //     console.log(res);\n  //     if (res?.data) {\n  //       dispatch({\n  //         type: FETCH_PROFILE_SUCCESS,\n  //         payload: res.data,\n  //       });\n  //     }\n  //   } catch (error) {\n  //     dispatch({\n  //       type: FETCH_PROFILE_FAIL,\n  //       payload: error?.response?.data?.message,\n  //     });\n  //   }\n  // };\n\n  const fetchProfileAction = async () => {\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${state?.userAuth?.token}`,\n        },\n      };\n      const res = await axios.get(`${API_URL_USER}/profile`,config);\n      console.log(\"My res \",res);\n      if (res?.data) {\n        dispatch({\n          type: FETCH_PROFILE_SUCCESS,\n          payload: res.data,\n        });\n      }\n    } catch (error) {\n      dispatch({\n        type: FETCH_PROFILE_FAIL,\n        payload: error?.response?.data?.message,\n      });\n    }\n  }; \n  //Logout\n  const logoutUserAction = () => {\n    dispatch({\n      type: LOGOUT,\n      payload: null,\n    });\n    //Redirect\n    window.location.href = \"/login\";\n  };\n  return (\n    <authContext.Provider\n      value={{\n        loginUserAction,\n        userAuth: state,\n        token: state?.userAuth?.token,\n        fetchProfileAction,\n        profile: state?.profile,\n        error: state?.error,\n        logoutUserAction,\n        registerUserAction,\n      }}\n    >\n      {children}\n    </authContext.Provider>\n  );\n};\n\nexport default AuthContextProvider;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}