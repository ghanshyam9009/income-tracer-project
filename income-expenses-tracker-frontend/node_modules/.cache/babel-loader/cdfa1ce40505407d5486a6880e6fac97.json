{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ghans\\\\Downloads\\\\income-expenses-frontend (2)\\\\income-expenses-frontend\\\\src\\\\components\\\\context\\\\AuthContext\\\\AuthContext.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport { LOGIN_SUCCESS, LOGIN_FAILED, FETCH_PROFILE_FAIL, FETCH_PROFILE_SUCCESS, LOGOUT, REGISTER_SUCCESS, REGISTER_FAIL } from \"./authActionTypes\";\nimport { API_URL_USER } from \"../../../utils/apiURL\"; //auth context\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const authContext = /*#__PURE__*/createContext(); //Initial state\n\nconst INITIAL_STATE = {\n  userAuth: JSON.parse(localStorage.getItem(\"userAuth\")),\n  error: null,\n  loading: false,\n  profile: null\n}; //Auth Reducer\n\nconst reducer = (state, action) => {\n  const {\n    type,\n    payload\n  } = action;\n\n  switch (type) {\n    //Register\n    case REGISTER_SUCCESS:\n      return { ...state,\n        loading: false,\n        error: null,\n        userAuth: payload\n      };\n\n    case REGISTER_FAIL:\n      return { ...state,\n        error: payload,\n        loading: false,\n        userAuth: null\n      };\n\n    case LOGIN_SUCCESS:\n      //Add user to localstorage\n      localStorage.setItem(\"userAuth\", JSON.stringify(payload));\n      return { ...state,\n        loading: false,\n        error: null,\n        userAuth: payload\n      };\n\n    case LOGIN_FAILED:\n      return { ...state,\n        error: payload,\n        loading: false,\n        userAuth: null\n      };\n    // Profile\n\n    case FETCH_PROFILE_SUCCESS:\n      return { ...state,\n        loading: false,\n        error: null,\n        profile: payload\n      };\n\n    case FETCH_PROFILE_FAIL:\n      return { ...state,\n        loading: false,\n        error: payload,\n        profile: null\n      };\n    // logout\n\n    case LOGOUT:\n      //remove from storage\n      localStorage.removeItem(\"userAuth\");\n      return { ...state,\n        loading: false,\n        error: null,\n        userAuth: null\n      };\n\n    default:\n      return state;\n  }\n}; //Provider\n\n\nconst AuthContextProvider = _ref => {\n  _s();\n\n  var _state$userAuth2;\n\n  let {\n    children\n  } = _ref;\n  const [state, dispatch] = useReducer(reducer, INITIAL_STATE); //login action\n\n  const loginUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n\n    try {\n      var _res$data;\n\n      const res = await axios.post(`${API_URL_USER}/login`, formData, config);\n\n      if ((res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.status) === \"success\") {\n        dispatch({\n          type: LOGIN_SUCCESS,\n          payload: res.data\n        });\n      } //Redirect\n\n\n      window.location.href = \"/dashboard\";\n    } catch (error) {\n      var _error$response, _error$response$data;\n\n      dispatch({\n        type: LOGIN_FAILED,\n        payload: error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message\n      });\n    }\n  }; //login action\n\n\n  const registerUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n\n    try {\n      var _res$data2;\n\n      const res = await axios.post(`${API_URL_USER}/register`, formData, config);\n\n      if ((res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.status) === \"success\") {\n        dispatch({\n          type: REGISTER_SUCCESS,\n          payload: res.data\n        });\n      } //Redirect\n\n\n      window.location.href = \"/login\";\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message\n      });\n    }\n  }; //Profile Action\n\n\n  const fetchProfileAction = async () => {\n    try {\n      var _state$userAuth;\n\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${state === null || state === void 0 ? void 0 : (_state$userAuth = state.userAuth) === null || _state$userAuth === void 0 ? void 0 : _state$userAuth.token}`\n        }\n      };\n      const res = await axios.get(`${API_URL_USER}/profile/`, config);\n      console.log(res);\n\n      if (res !== null && res !== void 0 && res.data) {\n        dispatch({\n          type: FETCH_PROFILE_SUCCESS,\n          payload: res.data\n        });\n      }\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n\n      dispatch({\n        type: FETCH_PROFILE_FAIL,\n        payload: error === null || error === void 0 ? void 0 : (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message\n      });\n    }\n  }; //Logout\n\n\n  const logoutUserAction = () => {\n    dispatch({\n      type: LOGOUT,\n      payload: null\n    }); //Redirect\n\n    window.location.href = \"/login\";\n  };\n\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: {\n      loginUserAction,\n      userAuth: state,\n      token: state === null || state === void 0 ? void 0 : (_state$userAuth2 = state.userAuth) === null || _state$userAuth2 === void 0 ? void 0 : _state$userAuth2.token,\n      fetchProfileAction,\n      profile: state === null || state === void 0 ? void 0 : state.profile,\n      error: state === null || state === void 0 ? void 0 : state.error,\n      logoutUserAction,\n      registerUserAction\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthContextProvider, \"ih+Vd9fHXqjzC8XFlo5K5uS4lm8=\");\n\n_c = AuthContextProvider;\nexport default AuthContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useReducer","axios","LOGIN_SUCCESS","LOGIN_FAILED","FETCH_PROFILE_FAIL","FETCH_PROFILE_SUCCESS","LOGOUT","REGISTER_SUCCESS","REGISTER_FAIL","API_URL_USER","authContext","INITIAL_STATE","userAuth","JSON","parse","localStorage","getItem","error","loading","profile","reducer","state","action","type","payload","setItem","stringify","removeItem","AuthContextProvider","children","dispatch","loginUserAction","formData","config","headers","res","post","data","status","window","location","href","response","message","registerUserAction","fetchProfileAction","Authorization","token","get","console","log","logoutUserAction"],"sources":["C:/Users/ghans/Downloads/income-expenses-frontend (2)/income-expenses-frontend/src/components/context/AuthContext/AuthContext.js"],"sourcesContent":["import { createContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport {\n  LOGIN_SUCCESS,\n  LOGIN_FAILED,\n  FETCH_PROFILE_FAIL,\n  FETCH_PROFILE_SUCCESS,\n  LOGOUT,\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n} from \"./authActionTypes\";\nimport { API_URL_USER } from \"../../../utils/apiURL\";\n\n//auth context\nexport const authContext = createContext();\n\n//Initial state\nconst INITIAL_STATE = {\n  userAuth: JSON.parse(localStorage.getItem(\"userAuth\")),\n  error: null,\n  loading: false,\n  profile: null,\n};\n//Auth Reducer\n\nconst reducer = (state, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    //Register\n    case REGISTER_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: payload,\n      };\n    case REGISTER_FAIL:\n      return {\n        ...state,\n        error: payload,\n        loading: false,\n        userAuth: null,\n      };\n\n    case LOGIN_SUCCESS:\n      //Add user to localstorage\n      localStorage.setItem(\"userAuth\", JSON.stringify(payload));\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: payload,\n      };\n    case LOGIN_FAILED:\n      return {\n        ...state,\n        error: payload,\n        loading: false,\n        userAuth: null,\n      };\n    // Profile\n    case FETCH_PROFILE_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        profile: payload,\n      };\n    case FETCH_PROFILE_FAIL:\n      return {\n        ...state,\n        loading: false,\n        error: payload,\n        profile: null,\n      };\n    // logout\n    case LOGOUT:\n      //remove from storage\n      localStorage.removeItem(\"userAuth\");\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: null,\n      };\n    default:\n      return state;\n  }\n};\n\n//Provider\nconst AuthContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, INITIAL_STATE);\n\n  //login action\n  const loginUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    try {\n      const res = await axios.post(`${API_URL_USER}/login`, formData, config);\n      if (res?.data?.status === \"success\") {\n        dispatch({\n          type: LOGIN_SUCCESS,\n          payload: res.data,\n        });\n      }\n      //Redirect\n      window.location.href = \"/dashboard\";\n    } catch (error) {\n      dispatch({\n        type: LOGIN_FAILED,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n\n  //login action\n  const registerUserAction = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    try {\n      const res = await axios.post(\n        `${API_URL_USER}/register`,\n        formData,\n        config\n      );\n      if (res?.data?.status === \"success\") {\n        dispatch({\n          type: REGISTER_SUCCESS,\n          payload: res.data,\n        });\n      }\n      //Redirect\n      window.location.href = \"/login\";\n    } catch (error) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n\n  //Profile Action\n  const fetchProfileAction = async () => {\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${state?.userAuth?.token}`,\n        },\n      };\n      const res = await axios.get(`${API_URL_USER}/profile/`, config);\n      console.log(res);\n      if (res?.data) {\n        dispatch({\n          type: FETCH_PROFILE_SUCCESS,\n          payload: res.data,\n        });\n      }\n    } catch (error) {\n      dispatch({\n        type: FETCH_PROFILE_FAIL,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n  //Logout\n  const logoutUserAction = () => {\n    dispatch({\n      type: LOGOUT,\n      payload: null,\n    });\n    //Redirect\n    window.location.href = \"/login\";\n  };\n  return (\n    <authContext.Provider\n      value={{\n        loginUserAction,\n        userAuth: state,\n        token: state?.userAuth?.token,\n        fetchProfileAction,\n        profile: state?.profile,\n        error: state?.error,\n        logoutUserAction,\n        registerUserAction,\n      }}\n    >\n      {children}\n    </authContext.Provider>\n  );\n};\n\nexport default AuthContextProvider;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}