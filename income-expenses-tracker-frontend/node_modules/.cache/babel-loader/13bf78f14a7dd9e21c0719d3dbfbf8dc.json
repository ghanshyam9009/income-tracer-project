{"ast":null,"code":"import _regeneratorRuntime from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/income tracer project/income-expenses-tracker (frontend)/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useReducer}from\"react\";import axios from\"axios\";import{TRANSACTION_CREATION_STARTED,TRANSACTION_CREATION_SUCCES,TRANSACTION_CREATION_FAIL}from\"./transactionsActionTypes\";import{API_URL_TRANSACTION}from\"../../../utils/apiURL\";import{jsx as _jsx}from\"react/jsx-runtime\";export var transactionContext=/*#__PURE__*/createContext();var INITIAL_STATE={transaction:null,transactions:[],loading:false,error:null,token:JSON.parse(localStorage.getItem(\"userAuth\"))};var transactionReducer=function transactionReducer(state,action){var type=action.type,payload=action.payload;switch(type){case TRANSACTION_CREATION_SUCCES:return _objectSpread(_objectSpread({},state),{},{loading:false,transaction:payload});case TRANSACTION_CREATION_FAIL:return _objectSpread(_objectSpread({},state),{},{loading:false,error:payload});default:return state;}};export var TransactionContextProvider=function TransactionContextProvider(_ref){var children=_ref.children;var _useReducer=useReducer(transactionReducer,INITIAL_STATE),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];//create account\nvar createTransactionAction=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(accountData){var _state$token,_res$data,config,res,_error$response,_error$response$data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;//header\nconfig={headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(state===null||state===void 0?void 0:(_state$token=state.token)===null||_state$token===void 0?void 0:_state$token.token)}};//request\n_context.next=4;return axios.post(API_URL_TRANSACTION,accountData,config);case 4:res=_context.sent;console.log(res);if((res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.status)===\"success\"){dispatch({type:TRANSACTION_CREATION_SUCCES,payload:res===null||res===void 0?void 0:res.data});}//Redirect\n//  window.location.href = \"/account-details/:accountID\";\nwindow.location.href=\"/dashboard\";_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);dispatch({type:TRANSACTION_CREATION_FAIL,payload:_context.t0===null||_context.t0===void 0?void 0:(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message});case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function createTransactionAction(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(transactionContext.Provider,{value:{transaction:state.transaction,transactions:state.transactions,createTransactionAction:createTransactionAction,error:state===null||state===void 0?void 0:state.error},children:children});};","map":{"version":3,"names":["React","createContext","useReducer","axios","TRANSACTION_CREATION_STARTED","TRANSACTION_CREATION_SUCCES","TRANSACTION_CREATION_FAIL","API_URL_TRANSACTION","transactionContext","INITIAL_STATE","transaction","transactions","loading","error","token","JSON","parse","localStorage","getItem","transactionReducer","state","action","type","payload","TransactionContextProvider","children","dispatch","createTransactionAction","accountData","config","headers","Authorization","post","res","console","log","data","status","window","location","href","response","message"],"sources":["C:/income tracer project/income-expenses-tracker (frontend)/src/components/context/TransactionContext/TransactionsContext.js"],"sourcesContent":["import React, { createContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport {\n  TRANSACTION_CREATION_STARTED,\n  TRANSACTION_CREATION_SUCCES,\n  TRANSACTION_CREATION_FAIL,\n} from \"./transactionsActionTypes\";\nimport { API_URL_TRANSACTION } from \"../../../utils/apiURL\";\n\nexport const transactionContext = createContext();\n\nconst INITIAL_STATE = {\n  transaction: null,\n  transactions: [],\n  loading: false,\n  error: null,\n  token: JSON.parse(localStorage.getItem(\"userAuth\")),\n};\nconst transactionReducer = (state, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    case TRANSACTION_CREATION_SUCCES:\n      return {\n        ...state,\n        loading: false,\n        transaction: payload,\n      };\n    case TRANSACTION_CREATION_FAIL:\n      return {\n        ...state,\n        loading: false,\n        error: payload,\n      };\n    default:\n      return state;\n  }\n};\n\nexport const TransactionContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(transactionReducer, INITIAL_STATE);\n\n  //create account\n  const createTransactionAction = async accountData => {\n    try {\n      //header\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${state?.token?.token}`,\n        },\n      };\n      //request\n      const res = await axios.post(API_URL_TRANSACTION, accountData, config);\n      console.log(res);\n      if (res?.data?.status === \"success\") {\n        dispatch({ type: TRANSACTION_CREATION_SUCCES, payload: res?.data });\n      }\n       //Redirect\n      //  window.location.href = \"/account-details/:accountID\";\n       window.location.href = \"/dashboard\"; \n\n    } catch (error) {\n      console.log(error);\n      dispatch({\n        type: TRANSACTION_CREATION_FAIL,\n        payload: error?.response?.data?.message,\n      });\n    }\n  };\n  return (\n    <transactionContext.Provider\n      value={{\n        transaction: state.transaction,\n        transactions: state.transactions,\n        createTransactionAction,\n        error: state?.error,\n      }}\n    >\n      {children}\n    </transactionContext.Provider>\n  );\n};\n"],"mappings":"mlBAAA,MAAOA,MAAP,EAAgBC,aAAhB,CAA+BC,UAA/B,KAAiD,OAAjD,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OACEC,4BADF,CAEEC,2BAFF,CAGEC,yBAHF,KAIO,2BAJP,CAKA,OAASC,mBAAT,KAAoC,uBAApC,C,2CAEA,MAAO,IAAMC,mBAAkB,cAAGP,aAAa,EAAxC,CAEP,GAAMQ,cAAa,CAAG,CACpBC,WAAW,CAAE,IADO,CAEpBC,YAAY,CAAE,EAFM,CAGpBC,OAAO,CAAE,KAHW,CAIpBC,KAAK,CAAE,IAJa,CAKpBC,KAAK,CAAEC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,CALa,CAAtB,CAOA,GAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,CAACC,KAAD,CAAQC,MAAR,CAAmB,CAC5C,GAAQC,KAAR,CAA0BD,MAA1B,CAAQC,IAAR,CAAcC,OAAd,CAA0BF,MAA1B,CAAcE,OAAd,CACA,OAAQD,IAAR,EACE,IAAKjB,4BAAL,CACE,sCACKe,KADL,MAEER,OAAO,CAAE,KAFX,CAGEF,WAAW,CAAEa,OAHf,GAKF,IAAKjB,0BAAL,CACE,sCACKc,KADL,MAEER,OAAO,CAAE,KAFX,CAGEC,KAAK,CAAEU,OAHT,GAKF,QACE,MAAOH,MAAP,CAdJ,CAgBD,CAlBD,CAoBA,MAAO,IAAMI,2BAA0B,CAAG,QAA7BA,2BAA6B,MAAkB,IAAfC,SAAe,MAAfA,QAAe,CAC1D,gBAA0BvB,UAAU,CAACiB,kBAAD,CAAqBV,aAArB,CAApC,4CAAOW,KAAP,iBAAcM,QAAd,iBAEA;AACA,GAAMC,wBAAuB,6FAAG,iBAAMC,WAAN,+MAE5B;AACMC,MAHsB,CAGb,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,kBAAYX,KAAZ,SAAYA,KAAZ,+BAAYA,KAAK,CAAEN,KAAnB,uCAAY,aAAcA,KAA1B,CAFN,CADI,CAHa,CAS5B;AAT4B,sBAUVX,MAAK,CAAC6B,IAAN,CAAWzB,mBAAX,CAAgCqB,WAAhC,CAA6CC,MAA7C,CAVU,QAUtBI,GAVsB,eAW5BC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,GAAI,CAAAA,GAAG,OAAH,EAAAA,GAAG,SAAH,mBAAAA,GAAG,CAAEG,IAAL,8CAAWC,MAAX,IAAsB,SAA1B,CAAqC,CACnCX,QAAQ,CAAC,CAAEJ,IAAI,CAAEjB,2BAAR,CAAqCkB,OAAO,CAAEU,GAAF,SAAEA,GAAF,iBAAEA,GAAG,CAAEG,IAAnD,CAAD,CAAR,CACD,CACA;AACD;AACCE,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,YAAvB,CAjB2B,iFAoB5BN,OAAO,CAACC,GAAR,cACAT,QAAQ,CAAC,CACPJ,IAAI,CAAEhB,yBADC,CAEPiB,OAAO,kEAAE,YAAOkB,QAAT,gEAAE,gBAAiBL,IAAnB,+CAAE,qBAAuBM,OAFzB,CAAD,CAAR,CArB4B,qEAAH,kBAAvBf,wBAAuB,6CAA7B,CA2BA,mBACE,KAAC,kBAAD,CAAoB,QAApB,EACE,KAAK,CAAE,CACLjB,WAAW,CAAEU,KAAK,CAACV,WADd,CAELC,YAAY,CAAES,KAAK,CAACT,YAFf,CAGLgB,uBAAuB,CAAvBA,uBAHK,CAILd,KAAK,CAAEO,KAAF,SAAEA,KAAF,iBAAEA,KAAK,CAAEP,KAJT,CADT,UAQGY,QARH,EADF,CAYD,CA3CM"},"metadata":{},"sourceType":"module"}